# -*- coding: utf-8 -*-

import nltk
nltk.download(['punkt_tab', 'stopwords', 'averaged_perceptron_tagger_eng', 'vader_lexicon'])

from nltk.sentiment.vader import SentimentIntensityAnalyzer # type: ignore
from nltk.tokenize import word_tokenize # type: ignore
from nltk.corpus import stopwords # type: ignore
import asyncio
from googletrans import Translator # type: ignore



async def split_to_segments(text):
    lenght = text.__len__()
    segments = lenght//3000 + 1
    segments_list = []
    for i in range(1, segments):
        try:
            seg_len = 3000
            while text[seg_len] != '.' : seg_len = seg_len - 1
            segments_list.append(text[0:seg_len+1])
            text = text.replace(segments_list[i-1], "")   
        except Exception as e: 
            print(e)
    segments_list.append(text)
    return segments_list

async def translate_text(text, first_lg, second_lg):
    translate_result = ""
    text_list = await split_to_segments(text)
    async with Translator() as translator:
        for segment in text_list:
            result = await translator.translate(segment, src=first_lg, dest=second_lg)
            translate_result=translate_result + result.text
    return translate_result



async def main():
    raw = await translate_text("""Дуже цікаво пояснює матеріал. Завжди допомагає, якщо щось незрозуміло. Чудова людина, яка надихає вчитися. Його уроки — найкращі! Вчитель з почуттям гумору, це додає урокам шарму. Дуже добрий і терплячий. Пояснює все просто і зрозуміло. Його підхід до учнів просто вражає. Уроки проходять дуже продуктивно. Завжди чекаю наступний урок із задоволенням. Справедливий і завжди чесний. Знання, які я тут отримую, дійсно корисні. Дуже кваліфікований спеціаліст. Атмосфера на уроках чудова! Завдяки йому я полюбив предмет. Вчитель — справжній професіонал. Дуже уважний до деталей. Завжди вміє мотивувати. Його приклади з життя — це те, що допомагає все зрозуміти. Найкращий вчитель, якого я знаю. Завжди відкритий до діалогу. Чіткий і структурований підхід. Вчитель, якого неможливо не поважати. Має відмінний стиль викладання. Його уроки цікаві та інтерактивні. Дуже сучасний підхід до навчання. Уроки проходять швидко й легко. Найкращий у своєму напрямку. Дбає про кожного учня. Завжди доступно відповідає на всі запитання. Знання, отримані тут, знадобляться на все життя. Справжній приклад для наслідування. Чудова організація навчального процесу. Дякую за ваш труд і підтримку! Його методи викладання просто геніальні. Не завжди вистачає часу на всі питання. Уроки досить стандартні, але зрозумілі. Іноді пояснює трохи швидко. Ставлення до учнів нормальне. Знання дає, але хотілося б більше практики. Не вистачає інтерактиву на уроках. Уроки проходять в спокійному темпі. Зазвичай все зрозуміло, але бувають винятки. Загалом нормальний вчитель. Іноді відчувається монотонність у поясненнях. Добре розбирається у своєму предметі. Хотілося б більше прикладів із життя. Стиль викладання досить класичний. Не завжди уважний до деталей. Уроки йдуть за розкладом, все організовано. Може бути трохи суворим. Уроки без емоцій, але корисні. Пояснює досить зрозуміло, але не завжди цікаво. Часом відволікається на сторонні теми. Подає матеріал чітко, але без натхнення. Уроки трохи одноманітні. Уміє тримати дисципліну. Підхід до учнів нейтральний. Виконує свою роботу, але без ентузіазму. Добре знає програму, але хотілося б більше творчості. Уроки стандартні, але знання дає. Загалом нормальний викладач, нічого особливого. Подає матеріал за підручником, без змін. Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Я боюся, що не здам цю дисципліну, тому що він абсолютно не допомагає. Вчитель звичайний, нічим не виділяється. Часом уроки проходять занадто спокійно. Постійно кричить на учнів. Пояснення дуже складні та незрозумілі. Неуважний до потреб учнів. Завжди незадоволений класом. Його уроки дуже нудні. Ставлення до учнів залишає бажати кращого. Не пояснює, якщо щось незрозуміло. Занадто суворий та байдужий. Уроки проходять хаотично. Постійно запізнюється на уроки. Взагалі не вміє зацікавити предметом. Лише читає підручник, без жодних пояснень. Постійно критикує учнів без підстав. Відповідає на запитання дуже грубо. Подає матеріал дуже швидко, нічого не зрозуміло. Не вміє організувати навчальний процес. Його методи викладання застарілі. Я боюся, що не здам цю дисципліну Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Завжди допомагає, якщо щось незрозуміло.Я боюся, що не здам цю дисципліну, тому що він абсолютно не допомагає.""", "uk", "en")
    tokens = word_tokenize(raw)
    tokens_lowercase = [w.lower() for w in tokens if w.isalpha()]
    stop_words = set(stopwords.words('english'))
    tokens_filtered = [w for w in tokens_lowercase if w not in stop_words]
    adjectives = []
    
    list_pos = nltk.pos_tag(tokens_filtered)
    adjectives = [word[0] for word in list_pos if word[1] == "JJ"]
    sia = SentimentIntensityAnalyzer()
    final_result = {}
    for i in adjectives:
        if i in final_result.keys():
            final_result[i]["frequency"] = final_result[i]["frequency"] + 1
        else:
            polarity = sia.polarity_scores(i)
            final_result[i] = {"frequency":1, "sentiment":{}}        
            final_result[i]["sentiment"] = polarity
    
    print(final_result)
    

asyncio.run(main())
